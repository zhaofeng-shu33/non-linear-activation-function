\documentclass{article}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{hyperref}
\def\E{\mathbb{E}}
\def\R{\mathbb{R}}
\title{High order moment of uniform distribution on the sphere}
\author{Feng Zhao}
\begin{document}
\maketitle
Consider $X_1, \dots, X_n \sim N(0, 1)$. Let $X = \sqrt{X_1^2 + \dots + X_n^2}$.
$Y_i = \frac{X_i}{X}$ Then $Y=(Y_1, \dots, Y_n)$ are uniformly distributed on the sphere.
Using symmetric property we have $\E[Y_i^2] = \frac{1}{n}$. Our problem is to compute the higher order moments of $\E[Y_i^k]$ where $k$ is even. Notice that $\E[Y_i^k]=0$ if $k$ is odd.

First we consider the simple case in which $n=2$ and we show that
\begin{equation}\label{eq:n2}
\int_{\R}\int_{\R} \frac{x^{2k}}{(x^2+y^2)^k} p(x)p(y)dxdy = \frac{(2k-1)!!}{(2k)!!}
\end{equation}
where $p(x) = \frac{1}{\sqrt{2\pi}} \exp(-\frac{x^2}{2})$.
We can let $y=xt$ and the integral is transformed to
\begin{align*}
\int_{\R}\int_{\R} \frac{x^{2k}}{(x^2+y^2)^k} p(x)p(y)dxdy & =
\frac{2}{\pi}\int_{0}^{+\infty}\int_{0}^{+\infty} \frac{x}{(1+t^2)^k} \exp(-\frac{1}{2}x^2(1+t^2))dxdt \\
&=
\frac{2}{\pi}\int_{0}^{+\infty} \frac{1}{(1+t^2)^{k+1}}dt \\
&= \frac{2}{\pi}\int_{0}^{\frac{\pi}{2}} cos^{2k}(u)dt \\
\end{align*}
The integral of $sin(x)$ over $[0, \frac{\pi}{2}]$ is a well-known \href{https://math.stackexchange.com/questions/50447/integration-of-powers-of-the-sin-x}{formula}. And we conclude that the right hand size of equation \eqref{eq:n2} equals
$\frac{(2k-1)!!}{(2k)!!}$.

Next we consider the case when $n>2$. Let $Z = X_2^2 + \dots + X_{n-1}^2$ and $Z$ is chi-square distribution. We have
\begin{equation}\label{eq:n3}
\int_{\R}\int_{0}^{+\infty} \frac{x^{2k}}{(x^2+z)^k} p(x)q(z)dxdz = \frac{\Gamma(\frac{n}{2}) \Gamma(\frac{2k+1}{2})}{\sqrt{\pi} \Gamma(\frac{2k+n}{2})} = \prod_{i=0}^{k-1} \frac{1+2i}{n+2i}
\end{equation}
where $q(z) = \frac{1}{2^{\frac{n-1}{2}}\Gamma(\frac{n-1}{2})} z ^{\frac{n-1}{2} - 1} \exp(-\frac{z}{2})$
This time we let $z=x^2 t$ and the integral is transformed to
\begin{align*}
\int_{\R}\int_{0}^{+\infty} \frac{x^{2k}}{(x^2+z)^k} p(x)q(z)dxdz & = \\
\frac{1}{2^{\frac{n}{2}-1}\sqrt{\pi}\Gamma(\frac{n-1}{2})} \int_{0}^{+\infty}t^{\frac{n-1}{2}-1}(1+t)^{-k}dt\int_{0}^{+\infty}x^{n-1} \exp(-\frac{1}{2}x^2(1+t)) dx &=
\\
\frac{1}{2^{\frac{n}{2}-1}\sqrt{\pi}\Gamma(\frac{n-1}{2})} \int_{0}^{+\infty}t^{\frac{n-1}{2}-1}(1+t)^{-k-\frac{n}{2}}dt\int_{0}^{+\infty}x^{n-1} \exp(-\frac{1}{2}x^2) dx &=
\\
\frac{2}{\sqrt{\pi}\Gamma(\frac{n-1}{2})} \int_{0}^{+\infty}t^{\frac{n-1}{2}-1}(1+t)^{-k-\frac{n}{2}}dt\int_{0}^{+\infty}x^{n-1} \exp(-x^2) dx &=
\\
\frac{\Gamma(\frac{n}{2})}{\sqrt{\pi}\Gamma(\frac{n-1}{2})} \int_{0}^{+\infty}t^{\frac{n-1}{2}-1}(1+t)^{-k-\frac{n}{2}}dt
&= \\ (t=\tan^2 x) \frac{\Gamma(\frac{n}{2})}{\sqrt{\pi}\Gamma(\frac{n-1}{2})} 2 \int_0^{\frac{\pi}{2}} (\sin x)^{n-2} (\cos x)^{2k} dx
&= \\ \frac{\Gamma(\frac{n}{2})}{\sqrt{\pi}\Gamma(\frac{n-1}{2})} B(\frac{n-1}{2}, \frac{2k+1}{2})
&= \\ \frac{\Gamma(\frac{n}{2}) \Gamma(\frac{2k+1}{2})}{\sqrt{\pi} \Gamma(\frac{2k+n}{2})}
\end{align*}

We also consider the case when the moments of $\hat{Y} = Y_1^2 + \dots + Y_r^2$ is required. Let $Z = X_{r+1}^2 + \dots + X_n^2$. We have
\begin{equation}\label{eq:n4}
\int_{0}^{+\infty}\int_{0}^{+\infty} \frac{x^t}{(x+z)^t} p(x)q(z) dxdz = \frac{\Gamma(\frac{2t+r}{2})\Gamma(\frac{n}{2})}{\Gamma(\frac{2t+n}{2})\Gamma(\frac{r}{2})} = \prod_{i=0}^{t-1} \frac{2i+r}{2i+n}
\end{equation}
where $p(x)$ is pdf of chi square distribution with degree $r$ and $q(z)$ is pdf of chi square distribution with degree $n-r$.
\begin{align*}
\int_{0}^{+\infty}\int_{0}^{+\infty} \frac{x^t}{(x+z)^t} p(x)q(z) dxdz =
& \\ \frac{1}{2^{n/2} \Gamma(\frac{n-r}{2})\Gamma(\frac{r}{2})}\int_{0}^{+\infty}\int_{0}^{+\infty}\left(\frac{x}{x+z}\right)^t x^{\frac{r}{2}-1}\exp(-\frac{x}{2})z^{\frac{n-r}{2}-1}\exp(-\frac{z}{2})dxdz =
& \\ (z=xy) \frac{1}{2^{n/2} \Gamma(\frac{n-r}{2})\Gamma(\frac{r}{2})}\int_{0}^{+\infty}\int_{0}^{+\infty}\left(\frac{1}{1+y}\right)^t x^{\frac{n}{2}-1}\exp(-\frac{x(1+y)}{2})y^{\frac{n-r}{2}-1}dxdy =
& \\  \frac{1}{2^{n/2} \Gamma(\frac{n-r}{2})\Gamma(\frac{r}{2})}\int_{0}^{+\infty}\left(\frac{1}{1+y}\right)^t y^{\frac{n-r}{2}-1} dy\int_{0}^{+\infty} x^{\frac{n}{2}-1}\exp(-\frac{x(1+y)}{2})dx =
& \\  \frac{\Gamma(\frac{n}{2})}{\Gamma(\frac{n-r}{2})\Gamma(\frac{r}{2})}\int_{0}^{+\infty}\left(\frac{1}{1+y}\right)^{t+\frac{n}{2}} y^{\frac{n-r}{2}-1} dy =
& \\  \frac{\Gamma(\frac{n}{2})}{\Gamma(\frac{n-r}{2})\Gamma(\frac{r}{2})} B(\frac{n-r}{2}, \frac{2t+r}{2}) =
& \\ \frac{\Gamma(\frac{2t+r}{2})\Gamma(\frac{n}{2})}{\Gamma(\frac{2t+n}{2})\Gamma(\frac{r}{2})}
\end{align*}

\end{document}
